RewriteEngine On
RewriteBase /

RewriteRule config.inc.php error
RewriteRule server.inc.php error
RewriteRule mission.inc.php error

RewriteRule ^login index.php?action=home&subaction=checkLogin [QSA]
RewriteRule ^home index.php?action=home [QSA]
RewriteRule ^logout index.php?action=home&subaction=logout [QSA]
RewriteRule ^chat/([0-9]+) index.php?action=chat&conversation_id=$1 [QSA]
RewriteRule ^chat/(.*) index.php?action=chat&subaction=$1 [QSA]
RewriteRule ^chat index.php?action=chat [QSA]
RewriteRule ^admin/(.*) index.php?action=admin&subaction=$1 [QSA]
RewriteRule ^admin index.php?action=admin [QSA]
RewriteRule ^preferences index.php?action=preferences [QSA]
RewriteRule ^(file|css|js)/(.*) index.php?action=file&id=$2 [QSA]

ErrorDocument 400 /index.php?action=error
ErrorDocument 403 /index.php?action=error
ErrorDocument 404 /index.php?action=error
ErrorDocument 500 /index.php?action=error

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d